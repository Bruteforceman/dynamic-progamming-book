\chapter{ম্যাট্রিক্স এক্সপোনেন্সিয়েশন}

\section{শুরুর কথা}

নামটা শুনতে কঠিন মনে হলেও ম্যাট্রিক্স এক্সপোনেন্সিয়েশন আসলে তেমন কঠিন কিছু না। ম্যাট্রিক্স সম্পর্কে কমবেশি সবারই জানা থাকার কথা। তারপরেও যারা এ সম্পর্কে জানো না তারা ম্যাট্রিক্সকে 2D অ্যারের মত চিন্তা করতে পার। বাইরে থেকে দুটি একইরকমই দেখতে। যদি কোন ম্যাট্রিক্সের $n$ টি সারি আর $m$ টি কলাম থাকে তাহলে ম্যাট্রিক্সটিকে $n \times m$ ম্যাট্রিক্স বলা হয়। যেমন নিচের ম্যাট্রিক্সটি একটি $2 \times 3$ ম্যাট্রিক্স।
$$
\begin{pmatrix}
1 & 3 & 2\\
9 & 0 & 7
\end{pmatrix}
$$

ঠিক অ্যারের মতই কোন ম্যাট্রিক্স $A$ এর $i$ তম সারির $j$ তম সংখ্যাকে $A_{i, j}$ দিয়ে প্রকাশ করা হয়। যেমন উপরের ম্যাট্রিক্সের জন্য $A_{1, 1} = 1$, আবার $A_{2, 3} = 7$। ম্যাট্রিক্সের যোগ, বিয়োগও সম্ভব, তবে তুমি একটি $n \times m$ ম্যাট্রিক্সের সাথে আরেকটি $n \times m$ ম্যাট্রিক্সই যোগ বা বিয়োগ করতে পারবে। এক্ষেত্রে $A$ এবং  $B$ যোগ করে $C$ পাওয়া গেলে $C_{i, j} = A_{i, j} + B_{i, j}$ হতে হবে। যেমন

$$
\begin{pmatrix}
1 & 3\\
9 & 0
\end{pmatrix}
+ 
\begin{pmatrix}
2 & -1\\
3 & 1
\end{pmatrix}
=
\begin{pmatrix}
1 + 2 & 3 - 1\\
9 + 3 & 0 + 1
\end{pmatrix}
$$

তবে সবচেয়ে অদ্ভুত হচ্ছে ম্যাট্রিক্সের গুন। গুনের ক্ষেত্রে একটি $n \times m$ ম্যাট্রিক্সের সাথে কেবল একটা $m \times k$ ম্যাট্রিক্স গুন করতে পারবে এবং  গুণফল হবে একটা $n \times k$ ম্যাট্রিক্স। অর্থাৎ প্রথম ম্যাট্রিক্সের কলাম সংখ্যা আর দ্বিতীয় ম্যাট্রিক্সের সারি সংখ্যা সমান হতে হবে। $C$ যদি $A$ এবং $B$ ম্যাট্রিক্সের গুণফল হয় তাহলে 
$$ C_{i, j} = \sum_{x = 1}^{m} A_{i, x} \times B_{x, j}$$

যেমন ধর, 

$$
\begin{pmatrix}
1 & 3 & 2\\
9 & 0 & 7
\end{pmatrix}
\begin{pmatrix}
5 & 6 & 0 & 3 \\
0 & 2 & -1 & 1\\
1 & 1 & 4 & -1
\end{pmatrix} = 
\begin{pmatrix}
5 & 6 & 7 & 8\\
9 & 10 & 12 & 13
\end{pmatrix}
$$

এখানে $2 \times 3$ ম্যাট্রিক্সের সাথে $3 \times 4$ ম্যাট্রিক্স গুন করে $2 \times 4$ ম্যাট্রিক্স পাওয়া গিয়েছে। তবে গুণফলটা আসলে কীভাবে বের হল সেটা বুঝতে একটু ছোট উদাহরণ দেখা যাক। নিচের ২টি $2 \times 2$ ম্যাট্রিক্সের গুণ করা যাক
 $$
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
\begin{pmatrix}
p & q \\
r & s
\end{pmatrix} = 
\begin{pmatrix}
ap + br & aq + bs \\
cp + dr & cq + ds
\end{pmatrix}
$$

$C_{2, 1}$ এর কথা ধর। প্রথম ম্যাট্রিক্সের ২য় সারির সংখ্যাগুলো হচ্ছে $c$ এবং $d$, আবার দ্বিতীয় ম্যাট্রিক্সের ১ম কলামের সংখ্যাগুলো হচ্ছে $p$ এবং $r$। তাই $c$ এর সাথে $p$ গুন করেছি আর $d$ এর সাথে $q$ গুন  করেছি, এরপর গুণফল দুটিকে যোগ করে দিয়েছি। এজন্যই $C_{2, 1}$ এর মান $cp + dr$। অন্য পদগুলোও এভাবেই বের করা যাবে। (তোমরা হয়ত ভাবছ এমন অদ্ভুত ভাবে ম্যাট্রিক্স গুন করা হয় কেন। এর উত্তর জানতে লিনিয়ার আলজেব্রা পড়তে হবে। চাইলে 3blue1brown এর ভিডিও সিরিজটি দেখতে পারো)। 

ম্যাট্রিক্স গুণফলের সবচেয়ে চমদপ্রদক দিক হল অ্যাসোসিয়েটিভিটি। যেমন ধর তুমি তিনটি ম্যাট্রিক্স $A, B, C$ গুন করতে চাও, অর্থাৎ $ABC$ এর মান বের করতে চাও। তাহলে তুমি $AB$ এর সাথে $C$ কে গুন করলে যে ম্যাট্রিক্স পাওয়া যাবে, $A$ এর সাথে $BC$ কে গুন করলে একই ম্যাট্রিক্স পাওয়া যাবে। সহজ ভাষায় $A(BC) = (AB)C$। এই বৈশিষ্ট্য আমাদের পরে কাজে লাগবে। তবে সাবধান! $AB$ কিন্তু কখনই $BA$ এর সমান নয়। কোনটিকে আগে কোনটিকে পরে গুন করতে হবে তা লক্ষ্য রাখতে হবে। 

\section{ডাইনামিক প্রোগ্রামিং এর সাথে সম্পর্ক}
আবার ফিবোনাচ্চি সমস্যায় ফেরত যাওয়া যাক। রিকারেন্সটি নিশ্চয় মনে আছে,
\begin{align*}
& f_{0} = 0 \\
& f_{1} = 1 \\
& f_{n} = f_{n - 1} + f_{n - 2}
\end{align*}

আমরা এমন একটি $2 \times 2$ ম্যাট্রিক্স $A$ বের করতে চাই যেন,
$$
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix} 
\begin{pmatrix}
f_{n} \\
f_{n - 1}
\end{pmatrix}
= 
\begin{pmatrix}
f_{n + 1} \\
f_{n}
\end{pmatrix}
$$ 

অর্থাৎ $f_{n}$ ও $f_{n - 1}$ এর ভেক্টরের ($1 \times n$ ম্যাট্রিক্স গুলোকে ভেক্টর বলা হয়) সাথে এমন একটি ম্যাট্রিক্স গুন করতে যেন $f_{n + 1}$ ও $f_{n}$ এর ভেক্টর পাওয়া যায়। কাজটা কিন্তু খুব কঠিন না। একটু চেষ্টা করলেই বুঝবে $A = \begin{pmatrix}
  1 & 1\\ 
  1 & 0
\end{pmatrix}$  ম্যাট্রিক্সটি কাজ 
করে 
$$
\begin{pmatrix}
1 & 1 \\
1 & 0
\end{pmatrix} 
\begin{pmatrix}
f_{n} \\
f_{n - 1}
\end{pmatrix}
= 
\begin{pmatrix}
1f_{n} + 1f_{n - 1} \\
1f_{n} + 0f_{n - 1}
\end{pmatrix}
=
\begin{pmatrix}
f_{n + 1} \\
f_{n}
\end{pmatrix}
$$ 
এখন লক্ষ্য কর, $A$ ম্যাট্রিক্সটি যদি দুইবার গুন করি তাহলে কিন্তু $\begin{pmatrix}
  f_n\\ 
  f_{n - 1}
\end{pmatrix}$ থেকেই $\begin{pmatrix}
  f_{n + 2}\\ 
  f_{n + 1}
\end{pmatrix}$ পেয়ে যাবো।  কারণ 
$$
A \times A \times
\begin{pmatrix}
f_{n} \\
f_{n - 1}
\end{pmatrix}
= 
A \times
\begin{pmatrix}
f_{n + 1} \\
f_{n}
\end{pmatrix}
=
\begin{pmatrix}
f_{n + 2} \\
f_{n + 1}
\end{pmatrix}
$$ 

লক্ষ্য কর এখানে আমরা ম্যাট্রিক্সের অ্যাসোসিয়েটিভিটি ধর্মটি ব্যবহার করেছি। আবার যদি আমরা দুইবারের বদলে $m$ বার $A$ ম্যাট্রিক্সটি গুন করতাম, তাহলে  একইভাবে আমরা পাব 
$$
A^m
\begin{pmatrix}
f_{n} \\
f_{n - 1}
\end{pmatrix}
= 
A^{m-1}
\begin{pmatrix}
f_{n + 1} \\
f_{n}
\end{pmatrix}
= \cdots =
\begin{pmatrix}
f_{n + m} \\
f_{n + m - 1}
\end{pmatrix}
$$ 
উপরের সমীকরণে $n = 1$ বসালে আমরা পাব 
$$
\begin{pmatrix}
1 & 1 \\
1 & 0
\end{pmatrix} ^ {m}
\begin{pmatrix}
f_{1} \\
f_{0}
\end{pmatrix}
= 
\begin{pmatrix}
f_{m + 1} \\
f_{m}
\end{pmatrix}
$$ 
তোমরা হয়ত ভাবছ, এত কিছু বের করে আসলে কী লাভ হল। আমরা শুরুতে যখন $n$ তম ফিবোনাচ্চি নাম্বার বের করা শিখেছিলাম সেটার কমপ্লেক্সিটি ছিল $\mathcal{O}(n)$।  কিন্তু ম্যাট্রিক্স এক্সপনেন্সিয়েশন দিয়ে আমরা কাজটা $\mathcal{O}(\log{n})$ এই করে ফেলতে পারি। কারণ দেখ, $n$ তম ফিবনাচ্চি নাম্বার বের করতে আমাদের $A^{n}$ কে ফাস্ট ক্যালকুলেট করতে হবে। এজন্য কিন্তু আমরা সংখ্যার ক্ষেত্রে $a^b$ যেভাবে বাইনারি  এক্সপনেন্সিয়েশন দিয়ে বের করি সেভাবেই কাজটা করে ফেলতে পারি। অর্থাৎ $n$ জোড় হলে প্রথমে $A^{\frac{n}{2}}$ বের করে তাকে বর্গ করে দিলেই হচ্ছে। আবার $n$ বিজোড় হলে প্রথমে $A^{n - 1}$ বের করে তার সাথে $A$ গুন করে দিলেই হচ্ছে। এভাবে আমাদের $\mathcal{O}(\log{n})$ বার দুটি $2 \times 2$ ম্যাট্রিক্স গুন করতে হচ্ছে। দুটি $2 \times 2$ ম্যাট্রিক্স গুন করার কমপ্লেক্সিটি আমরা $\mathcal{O}(1)$ ই ধরতে পারি। তাই সবমিলিয়ে কমপ্লেক্সিটি হবে $\mathcal{O}(\log{n})$। 

তবে একটা জিনিশ বলে রাখা দরকার। এখানে ম্যাট্রিক্স এর আকার অনেক ছোট বলে আমরা দুটি ম্যাট্রিক্স গুন করার কমপ্লেক্সিটি $\mathcal{O}(1)$ ধরেছি। কিন্তু অনেক ক্ষেত্রে বেশ বড় ম্যাট্রিক্স লাগতে পারে (যেমন ধর $50 \times 50$ ম্যাট্রিক্স)। সেক্ষেত্রে কিন্তু ম্যাট্রিক্স গুন করার কমপ্লেক্সিটি $\mathcal{O}(1)$ ধরলে হবে না। খেয়াল করলে দেখবে দুটি $k \times k$ ম্যাট্রিক্স গুন করতে আমাদের $\mathcal{O}(k^3)$ কমপ্লেক্সিটি প্রয়োজন। সেক্ষেত্রে আমাদের ম্যাট্রিক্স এক্সপনেন্সিয়েশনের কমপ্লেক্সিটি হবে $\mathcal{O}(k^{3} \log{n})$

\section{আরো কিছু উদাহরণ}

আরেকটা উদাহরণ দেখা যাক। ধর এবার আমাদের রিকারেন্সটি হল 
\begin{align*}  
& f_{0} = 0 \\
& f_{1} = 2 \\
& f_{2} = 1 \\
& f_{n} = 2f_{n - 1} + 3f_{n - 2} - 7f_{n - 3}
\end{align*}

যেহেতু $f_{n}$ আগের তিনটি পদের ওপর নির্ভরশীল, তাই আমাদের এবার একটি $3 \times 3$ ম্যাট্রিক্স খুঁজতে হবে। ফিবোনাচ্চির ম্যাট্রিক্স তা যদি বুঝে থাক তাহলে এটা বের করাও তেমন কঠিন না। নিচের ম্যাট্রিক্সটা দেখ 
$$
\begin{pmatrix}
2 & 3 & -7 \\
1 & 0 & 0 \\
0 & 1 & 0
\end{pmatrix} 
\begin{pmatrix}
f_{n} \\
f_{n - 1} \\ 
f_{n - 2}
\end{pmatrix}
= 
\begin{pmatrix}
2f_{n} + 3f_{n - 1} - 7f_{n - 2}\\
1f_{n} + 0f_{n - 1} + 0f_{n - 2} \\
0f_{n} + 1f_{n - 1} + 0f_{n - 2}
\end{pmatrix}
=
\begin{pmatrix}
f_{n + 1} \\
f_{n} \\
f_{n - 1}
\end{pmatrix}
$$ 

এবার একটু জটিল উদাহরণ চেষ্টা করা যাক। ধর এবার আমাদের কাছে ২ টি রিকারেন্স আছে। 
\begin{align*}
& f_{n} = 2f_{n - 1} + g_{n - 2} \\
& g_{n} = g_{n - 1} + 3f_{n - 2} \\
\end{align*}

ধরে নাও $f_{0}, f_{1}, g_{0}, g_{1}$ এর মান জানা আছে। এবার আমাদের ভেক্টরে কিন্তু শুধু $f{n}, f_{n - 1}$ রাখলে চলবে না, বরং $g_{n}, g_{n - 1}$ এর মানও রাখতে হবে। যদি এটা ধরতে পারো তাহলে আগেরগুলোর মতই এটাও সমাধান করা যায় 
$$
\begin{pmatrix}
2 & 0 & 0 & 1 \\
1 & 0 & 0 & 0 \\
0 & 3 & 1 & 0 \\
0 & 0 & 1 & 0 \\
\end{pmatrix} 
\begin{pmatrix}
f_{n} \\
f_{n - 1} \\ 
g_{n} \\
g_{n - 1}
\end{pmatrix}
= 
\begin{pmatrix}
2f_{n} + g_{n - 1}\\
f_{n} \\
3f_{n - 1} + g_{n} \\
g_{n} 
\end{pmatrix}
=
\begin{pmatrix}
f_{n + 1} \\
f_{n} \\
g_{n + 1} \\
g_{n}
\end{pmatrix}
$$ 

$$

