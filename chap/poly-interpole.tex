\chapter{পলিনমিয়াল ইন্টারপোলেশন}

\section{পলিনমিয়াল নিয়ে কিছু কথা}
তোমরা বহুপদী বা পলিনমিয়াল নিয়ে আগে হয়ত কাজ করেছ। সবচেয়ে বহুল প্রচলিত উদাহরণ হচ্ছে দ্বিঘাতী সমীকরণগুলো। যেমন ধর 
$$2x^2 + 5x - 15$$
এটি একটি দ্বিঘাতী পলিনমিয়াল (second degree)। আবার নিচের পলিনমিয়ালটি একটি ত্রিঘাতী পলিনমিয়াল (third degree) 
$$x^3 - 5x^2 + 2x + 3$$
সাধারণভাবে বলতে গেলে 
$$P(x) = \sum_{i=0}^n a_{i} x^{i} = a_n x^n + a_{n - 1} x^{n - 1} + \dots + a_1 x + a_{0}$$ 
একটি $n$ ঘাতী পলিনমিয়াল ($n$ th degree)। পাঠ্যবইয়ের ভাষায় বলতে গেলে একটি $n$ ঘাতী পলিনমিয়াল হল এমন একটি এক চলক বিশিষ্ট ফাংশন যার ঘাতগুলো অঋণাত্মক পুর্ণসংখ্যা এবং সর্বোচ্চ ঘাত $n$।

পলিনমিয়াল কী তা হয়ত সবাই বুঝতে পেরেছ। কিন্তু পলিনমিয়াল ইন্টারপোলেশন বলতে আসলে কি বুঝাচ্ছে। আমরা জানি পলিনমিয়ালগুলো বিশেষ ধরনের ফাংশন। ধর আমাদের একটা অজানা পলিনমিয়াল $P(x)$ বের করতে হবে। শুধু জানা আছে  $P(x)$ একটি $n$ ডিগ্রি পলিনমিয়াল, এবং  দেওয়া আছে 
\begin{align*}
&P(x_0) = y_0 \\
&P(x_1) = y_1 \\
&P(x_2) = y_2 \\
&\vdots \\
&P(x_n) = y_n
\end{align*}
অর্থাৎ $n + 1$ টা $P(x) = y$ আকারের শর্ত দেওয়া আছে। শুধু এটুকু জানলেই কী $P(x)$ কে বের করে ফেলা সম্ভব? উত্তর হচ্ছে হ্যাঁ। সাধারণভাবে বলা যায়, যদি আমরা পলিনমিয়ালের ডিগ্রি বা ঘাত সম্পর্কে জানি (ধর এই ডিগ্রি $n$), এবং $n + 1$ টি \textbf{ভিন্ন ভিন্ন} $x$ এর জন্য $P(x)$ এর মান জানি, তাহলে আমরা পলিনমিয়ালটিকে বের করে ফেলতে পারব (শুধু তাই নয়, সব শর্ত মেনে চলে এমন পলিনমিয়াল একটাই পাওয়া যাবে)। এই যে $n + 1$ টি $P(x)$ এর মান থেকে আমরা $n$ ডিগ্রি পলিনমিয়ালটিকে বের করে ফেললাম এই প্রসেসটাকেই বলা হয় পলিনমিয়াল ইন্টারপোলেশন। 

পরবর্তী সেকশনে যাওয়ার আগে পলিনমিয়ালের ডিগ্রির ব্যাপারে কিছু কথা বলে নেওয়া দরকার। যদিও এগুলো সবারই জানার কথা, তবুও পরবর্তীতে এটা অনেক জায়গায় কাজে লাগবে বলে আবার বলছি 
\begin{enumerate}
\item একটি $n$ ডিগ্রি পলিনমিয়ালের সাথে আরেকটা $m$ ডিগ্রি পলিনমিয়াল যোগ করলে যোগফলের ডিগ্রি হবে $\max{(n, m)}$। 
\item একটি $n$ ডিগ্রি পলিনমিয়ালের সাথে আরেকটা $m$ ডিগ্রি পলিনমিয়াল বিয়োগ করলে বিয়োগফলের সর্বোচ্চ ডিগ্রি হবে $\max{(n, m)}$। তবে এর চেয়ে কমও হতে পারে।
\item একটি $n$ ডিগ্রি পলিনমিয়ালের সাথে আরেকটা $m$ ডিগ্রি পলিনমিয়াল গুন করলে গুনফলের ডিগ্রি হবে $n + m$।
\end{enumerate}

\section{কীভাবে পলিনমিয়াল ইন্টারপোলেশন কাজ করে }
কীভাবে পলিনমিয়ালটাকে বের করতে পারব সেটা বুঝার জন্য শুরুতেই একটা সহজ উদাহরণ দেখা যাক। 
\begin{example}
এমন দ্বিঘাতী পলিনমিয়াল বের কর যেন 
\begin{align*}
P(1) & = -3 \\
P(4) & = 0 \\
P(5) & = 0 
\end{align*}
\end{example}
\begin{solution}
তোমরা এটা নিশ্চয় জানো যদি কোন বহুপদী বা পলিনমিয়াল $f(x)$ এর জন্য $f(a) = 0$ হয় তাহলে $(x - a)$ পলিনমিয়ালটির একটি উৎপাদক। আমরা এ জিনিশটিই এখানে ব্যবহার করব। প্রশ্ন অনুযায়ী 

\begin{align*}
P(4) = 0 \\
P(5) = 0
\end{align*} 

তার মানে $(x - 4)$ এবং $(x - 5)$ উভয়েই $P(x)$ এর উৎপাদক। তাই আমরা $P(x)$ কে এভাবে লিখতে পারি

$$ P(x) = (x - 4)(x - 5)Q$$

এখানে $Q$ কিন্তু একটি ধ্রুবক হবে। কারণ হল $(x - 4)$ এবং $(x - 5)$ এর গুণফল নিজেই একটি দ্বিঘাতী পলিনমিয়াল। তাই $Q$ এর ঘাত শূন্য হতে হবে (উভয় পাশে ডিগ্রি বা ঘাত সমান রাখার জন্য), অর্থাৎ $Q$ কে একটি ধ্রুবকই হতে হবে। উপরের সমীকরণে আমরা $x = 1$ বসালেই কিন্তু $Q$ এর মান বের করে ফেলতে পারব 

\begin{align*}
P(1) = (1 - 4)(1 - 5)Q & = -3 \\
       \Rightarrow   Q & = \frac{-3}{12}     
\end{align*} 
সুতরাং $P(x)$ এর মান হচ্ছে 
$$P(x) = \frac{-3}{12} (x - 4)(x - 5)$$
এখন একে বিস্তার (expand) করে দিলেই $P(x)$ এর সব সহগগুলো বের করে ফেলতে পারব। 
\end{solution}

এবার আরেকটু কঠিন উদাহরণ দেখা যাক 
\begin{example}
এমন দ্বিঘাতী পলিনমিয়াল বের কর যেন 
\begin{align*}
P(1) & = -1 \\
P(2) & = -5 \\
P(3) & = 3
\end{align*}
\end{example}

\begin{solution}
আগের উদাহরণটি আমাদের জন্য সহজ হয়ে গিয়েছিল কেন বল তো? কারণ ছিল একটি বাদে বাকি $P(x)$ গুলোর মান $0$ ছিল। তাই আমরা $P(x)$ এর সব উৎপাদক বের করে ফেলতে পেরেছিলাম। কিন্তু এখানে কোন $P(x) = 0$ নেই। তাহলে কী করা যায়? 

আমরা কিছুটা আগের উদাহরণের মতই চেষ্টা করব। ধরে নাও, শুধু $P(x) = -1$ বাকি $P(x)$ গুলোর মান $0$ (অর্থাৎ $P(2) = P(3) = 0$)। তাহলে আমরা আগের উদাহরণের মত একটি পলিনমিয়াম বের করতে পারব। এই পলিনমিয়ালের নাম দিলাম $P_1$। 

একইভাবে এবার ধর শুধু $P(2) = -5$, বাকি $P(x)$ গুলোর মান $0$ (অর্থাৎ $P(1) = P(3) = 0$)। এবারও আরেকটি পলিনমিয়াল $P_2$ বের হবে। 

শেষমেষ তৃতীয় পলিনমিয়াল $P_3$ বের করার জন্য $P(3) = 3$ এবং $P(1) = P(2) = 0$ ধরে নিয়ে সমধান করতে হবে। এভাবে আমরা তিনটি পলিনমিয়াল $P_1$, $P_2$, $P_3$ পেলাম। 

আমাদের কাজ কিন্তু প্রায় শেষ। এখন পলিনমিয়াল তিনটিকে যোগ করে দিলেই কাঙ্ক্ষিত পলিনমিয়ালটি পেয়ে যাব। অর্থাৎ 
$$P = P_1 + P_2 + P_3$$

এর কারণও খুব সহজ।
\begin{align*}
P(1) & = P_1(1) + P_2(1) + P_3(1) = (-1) + 0 + 0 = &-1 \\
P(2) & = P_1(2) + P_2(2) + P_3(2) = 0 + (-5) + 0 = &-5 \\
P(3) & = P_1(3) + P_2(3) + P_3(3) = 0 + 0 + (+3) = &3
\end{align*}

$P_1$, $P_2$, $P_3$ সবগুলোই $2$ ডিগ্রি পলিনমিয়াল হওয়ায় $P$ ও $2$ ডিগ্রি পলিনমিয়াল হবে। অর্থাৎ যেহেতু $P$ সব শর্ত সিদ্ধ করে করে, তাই এটিই নির্ণেয় উত্তর। 
\end{solution}

এখানে আমরা দ্বিঘাতী পলিনমিয়ালের জন্য ইন্টারপোলেশন করেছি। কিন্তু একই নিয়মে উপরের ঘাতের পলিনমিয়ালগুলোর জন্যও ইন্টারপোলেশন করা যাবে। 

\section{ল্যাগ্রাঞ্জ ইন্টারপোলেশন}
আমরা কিন্তু ল্যাগ্রাঞ্জ ইন্টারপলেশন ইতোমধ্যে শিখে ফেলেছি। আগের উদাহরণগুলোয় আমরা যেভাবে পলিনমিয়ালটা বের করেছি সেটার প্রচলিত নাম হচ্ছে ল্যাগ্রাঞ্জ ইন্টারপোলেশন। $n$ ডিগ্রি পলিনমিয়ালের জন্য আমাদের ইন্টারপোলেশন করতে হবে এভাবে: যদি
\begin{align*}
&P(x_0) = y_0 \\
&P(x_1) = y_1 \\
&P(x_2) = y_2 \\
&\vdots \\
&P(x_n) = y_n
\end{align*}
হয়, তাহলে $n$ ডিগ্রি পলিনমিয়াল $P(x)$ বের করার জন্য 
\begin{itemize}
\item প্রথমে প্রত্যেক $i$ এর জন্য $P(x_i) = y_i$ এবং $P(x_j) = 0$ (যেখানে $i \neq j$) ধরে নিয়ে একটি পলিনমিয়াল বের করতে হবে। অর্থাৎ আমরা এভাবে $n + 1$ টি $n$ ডিগ্রি পলিনমিয়াল পাব। আগের উদাহরণটির মত যদি সমাধান কর তাইলে দেখবে $i$ তম পলিনমিয়াল $P_i$ হবে
$$P_{i}(x) = y_{i} \times \prod_{\substack{j = 0 \\ i \neq j}}^n \frac{x - x_j}{x_i - x_j}}$$
\item এরপর প্রত্যেক পলিনমিয়ালকে বিস্তার করে দাও (এ কাজটি ফাস্ট ফুরিয়ার ট্রান্সফর্ম দিয়ে করা যায়; তবে আমাদের বইয়ের আলোচনার জন্য এটি দরকার নেই, $\mathcal{O}(n^2)$ কম্পেক্সিটিতে বিস্তার করাই যথেষ্ট)।
\item শেষ ধাপে আমাদের $n + 1$ টি পলিনমিয়াল যোগ করে দিতে হবে।  যোগফলই হবে আমাদের কাঙ্ক্ষিত পলিনমিয়াল। অর্থাৎ 
$$P(x) = \sum_{i=0}^{n} P_i(x)$$
\end{itemize}
এটাই ল্যাগ্রাঞ্জ ইন্টারপলেশনের অ্যালগরিদম। 

\section{ডাইনামিক প্রোগ্রামিং-এর সাথে সম্পর্ক}
আপাতদৃষ্টিতে পলিনমিয়াল ইন্টারপোলেশনের সাথে ডাইনামিক প্রোগ্রামিং এর তেমন কোন সম্পর্ক বুঝা যাচ্ছে না। সত্য কথা বলতে কিছু উদাহরণ না দেখালে এ সম্পর্ক পুরোপুরি বুঝতে পারবে না। তবে মুল আইডিয়াটা হল এমন:

ধর তোমার ডিপির কোন এক স্টেট বিশাল বড় হয়ে গেছে ($10^9$ ধরতে পার)। এমন কিছু প্রব্লেমে ডিপিটাকে ওই স্টেটটির একটি পলিনমিয়াল হিসেবে চিন্তা করা যায়। অর্থাৎ ডিপি থেকে তুমি সেই স্টেটটি পুরোপুরি সরিয়ে ফেলতে পার। উদাহরণ হিসেবে ধর আমাদের একটি ডাইনামিক প্রোগ্রামিং এর জন্য $f_{i, j}$ বের করতে হবে। এখানে $j$ এর মান বিশাল বড় হতে পারে। তুমি কোনোভাবেই $f_{i, j}$ এর সব $j$ এর জন্য মান বের করতে পারবে না। তাহলে কী করা যায়? 
এক্ষেত্রে সমাধান হল $f_{i, j}$ কে $j$ এর একটি পলিনমিয়াল ধরতে পার। অর্থাৎ 
$$f_{i}(j) = \sum_{k = 0}^{n} a_{k} j^{k}$$

যদি এমন একটা পলিনমিয়াল সত্যিই থেকে থাকে, তাহলে কিন্তু আমাদের সব $j$ এর জন্য $f_{i, j}$ এর মান বের করতে হচ্ছে না। শুধু $a_{0}, a_{1}, a_{2}, \dots, a_{n}$ এর মান গুলো জানা থাকলেই আমরা যেকোনো $j$ এর জন্য সহজেই $f_{i, j}$ এর মান বের করতে পারব। 

এখন কথা হচ্ছে সব রিকারেন্সের জন্যই এমন একটি পলিনমিয়াল পাওয়া সম্ভব? অবশ্যই না। অনেক ক্ষেত্রেই এমন পাওয়া সম্ভব, আবার অনেক সময় পাওয়া সম্ভব না। কখন এটা খাটবে সেটা তোমাকেই প্রমাণ করে নিতে হবে। আসল কন্টেস্টের সময় অনেক ক্ষেত্রে অনুমান করাও যথেষ্ট (অভিজ্ঞ প্রোগ্রামাররা কিছু ক্ষেত্রে তাই করে)।  তবে এটা বুঝার একটি উপায় হল যদি তোমার একটি স্টেট বেশ বড় হয় এবং রিকারেন্সের মধ্যে সব বীজগাণিতিক অপারেটর ব্যবহার করা হয় (যেমন যোগ, বিয়োগ, গুন; $\max$, $\min$, $\text{xor}$ এসব কিন্তু বীজগাণিতিক অপারেটর নয়) তাহলে অনেক ক্ষেত্রেই পলিনমিয়াল  ইন্টারপোলেশন খাটে।  

\subsection{কিছু উদাহরণ}
এবার কিছু উদাহরণ দেখা যাক। 
\begin{problem} \textbf{(Luogu P4463)} তোমার কাছে দুটি সংখ্যা $n$  এবং $k$ দেওয়া আছে $(1 \leq n \leq 500, \, 1 \leq k \leq 10^9)$।  কোন একটা $n$ দৈর্ঘ্যের সিকুয়েন্স $a$ কে \textbf{ভালো} বলা হবে যদি $a$ এর সংখ্যাগুলো $1$ থেকে $k$ এর মধ্যে থাকে এবং সবগুলো সংখ্যা ভিন্ন ভিন্ন হয়। $a$ এর সংখ্যাগুলোর গুণফলকে বলা হয় $a$ সিকুয়েন্সটির ভ্যালু। তোমাকে যতগুলো সম্ভাব্য \textbf{ভালো} সিকুয়েন্স আছে সবগুলোর ভ্যালুর যোগফল বলতে হবে। 
\end{problem}
\begin{solution}
$k$ এর বিশাল লিমিট দেখে ভয় পেয়ে যেয়ো না। প্রথমে আমরা ডিপির স্টেট আর রিকারেন্সটা বের করি। বোঝাই যাচ্ছে স্টেটে আমাদের $n$ এবং $k$ দুটোই রাখা লাগবে। প্রব্লেমের সুবিধার্থে ধর আমাদের ভালো সিকুয়েন্সটার সংখ্যাগুলো ছোট থেকে বড় ক্রমানুসারে সাজানা থাকবে। এটা ধরে সমাধান করার পর $n!$ দিয়ে গুন করলেই উত্তর পেয়ে যাব। এখান থেকে আমরা রিকারেন্সটি লেখতে পারি এভাবে 
$$f_{n, k} = f_{n, k - 1} + k \times f_{n - 1, k - 1}$$
যদি সিকুয়েন্সটির শেষ সংখ্যাটি $k$ এর চেয়ে ছোট হয় তাহলে প্রতিটি সংখ্যা $1$ থেকে $k - 1$ এর মধ্যে থাকবে। এই $n$ টি দৈর্ঘ্যের ভালো সিকুয়েন্সগুলোর ভ্যালুর যোগফল হবে $f_{n, k - 1}$। আবার যদি শেষ সংখ্যাটি ঠিক $k$ এর সমান হয় তাহলে বাকি $n - 1$ টি সংখ্যা $1$  থেকে $k - 1$ এর মধ্যে থাকবে। এই $n - 1$ দৈর্ঘ্যের সিকুয়েন্সগুলর ভ্যালুর যোগফল হবে $f_{n - 1, k - 1}$।  তবে এর সাথে $k$ গুন দিতে হবে, কারণ $n$ তম সংখ্যাকে আমরা $k$ ধরেছি। তাই $n - 1$ দৈর্ঘ্যের সিকুয়েন্সগুলোর ভ্যালুগুলো $k$ দিয়ে গুন হবে। 
এ পর্যন্ত আমরা যা যা বের করলাম তা বেশ সহজ-ই। আগের চ্যাপ্টারেগুলোতে আমরা এর চেয়েও কঠিন ডিপি বের করেছিলাম। কিন্তু আমাদের সমস্যা এখনো মোটেই সমাধান হয়নি। এই ডিপি ক্যাল্কুলেট করতে আমাদের $\mathcal{O}(nk)$ কমপ্লেক্সিটি প্রয়োজন, যেটা আমাদের সাধ্যের বাইরে। 

এর সমাধান হল মনে মনে চিন্তা কর $f_{i, j}$ আসলে $j$ এর একটি পলিনমিয়াল। যেহেতু $j$ এর পলিনমিয়াল তাই $f_{i, j}$ এর পরিবর্তে আমরা $f_{i}(j)$ লেখব। কিন্তু কত ডিগ্রি পলিনমিয়াল সেটা বুঝব কি করে? আগের রিকারেন্সটাতে ফেরত যাই। রিকারেন্সটা একটু গুছিয়ে এভাবে লেখা যায় 
 $$f_{i}(j) - f_{i}(j - 1) = j \times f_{i - 1}(j - 1)$$
$f_{i}(j)$ এর পলিনমিয়ালের ডিগ্রি $g(i)$ হলে বামপক্ষের ডিগ্রি হবে $g(i) - 1$, কারণ যেকোনো পলিনমিয়াল $P$ এর জন্য $P(x) - P(x - 1)$ এর ডিগ্রি হয় $\deg{P} - 1$ (এটা নিজে প্রমাণ করার চেষ্টা কর)। আবার ডান পক্ষের ডিগ্রি হবে $g(i - 1) + 1$।  দুটি সমান হতে হলে $g(i) - 1 = g(i - 1) + 1$ হতে হবে। এটি সমাধান করলে দেখবে $g(i) = 2i$। অর্থাৎ $f_{n}(x)$ পলিমনিয়ালের ডিগ্রি $2n$।

আমাদের কাজ অনেক সহজ হয়ে গেল এখন। আগে আমাদের $f_{n}(1), f_{n}(2), \dots, f_{n}(k)$ সবগুলো মান বের করতে হচ্ছিল। কিন্তু এখন আমাদের জন্য শুধু $f_{n}(1), f_{n}(2), \dots, f_{n}(2n + 1)$ এর মানগুলো বের করাই যথেষ্ট। এরপর এই মান গুলো দিয়ে পলিমিয়াল ইন্টারপোলেশন করলেই আমরা $f_{n}$ এর পলিনমিয়াল পেয়ে যাব। লক্ষ্য কর, পলিনমিয়ালের ডিগ্রি $2n$ হওয়াতে আমাদের $2n + 1$ টা পয়েন্টে ডিপির মান বের করতে হয়েছে। 

আমাদের সমাধানের মধ্যে কিন্তু একটা ঘাপলা থেকে গিয়েছে। আমরা শুরুতেই ধরে নিয়েছিলাম $f_{i, j}$ আসলে $j$ এর একটি পলিনমিয়াল হবে। কিন্তু আসলেই যে পলিনমিয়াল হবে সেটা প্রমাণ করা হয় নি। সত্য কথা বলতে গেলে প্রমাণের অনেকখানি কাজ আমরা ইতোমধ্যে করে ফেলেছি। ডিগ্রির শর্তগুলো যখন বের করছিলাম তখন এর সাথে গাণিতিক আরোহ জুড়ে দিলেই প্রমাণ হয়ে যেত। এ কাজটি তোমাদের জন্য রেখে দিলাম।   
\end{solution}

\begin{problem} \textbf{(Codeforces Round 492 Div1 F)} $n$ টি নোডের একটি রুটেড ট্রি (rooted tree) দেওয়া থাকবে, যেখানে ১ নম্বর নোডটি হল রুট। ট্রি এর প্রত্যেক নোডে $1$ থেকে $D$ এর মধ্যে একটি সংখ্যা বসাতে হবে যেন রুট ব্যতীত যেকোনো নোডে বসানো সংখ্যা তার প্যারেন্টের সংখ্যার চেয়ে ছোট হয়। কতভাবে সংখ্যাগুলো বসানো যাবে। $(1 \leq n \leq 3000, \, 1 \leq D \leq 10^9)$
\end{problem} 
\begin{solution}
এটা অনেকটা আগের সমস্যাটার মতই। এর ডিপিটাও আগের সমস্যার ডিপির মত অনেকটা, তাই পড়া থামিয়ে নিজে বের করার চেষ্টা কর আগে। 

আমরা ডিপিটাকে সংজ্ঞায়িত করব এভাবে: $f_{u}(j) = $ নোড $u$ এর সাবট্রিতে $1$ থেকে $j$ এর মধ্যে সংখ্যাগুলো কতভাবে বসানো যায় যেন প্রত্যেক কোন চাইল্ডে প্যারেন্টের চেয়ে বড় সংখ্যা না থাকে। তাহলে রিকারেন্স হবে 
$$f_{u}(j) = f_{u}(j - 1) + \prod_{v \in \text{child(u)}} f_{v}(j - 1)$$ 

এর ব্যাখ্যাও প্রায় আগের সমস্যার মতই। $u$ নোডে যদি $x$ না বসাই তাহলে সাবট্রির প্রত্যেক নোডে $1$ থেকে $j - 1$ এর মধ্যে কোন একটি সংখ্যা বসাতে হবে, যেটি করা যায় $f_{u}(j - 1)$ উপায়ে। আর যদি $u$ নোডে $j$ বসাই তাহলে $u$ এর চাইল্ডগুলোতে  $1$ থেকে $j - 1$ এর মধ্যে সংখ্যাগুলো বসাতে হবে, যেটি করা যায় $\prod_{v \in \text{child(u)}} f_{v}(j - 1)$ উপায়ে। 

এবার আগের মতই আবার ধরব $f_{u}(j)$ একটি পলিনমিয়াল যার ডিগ্রি $g(u)$। রিকারেন্সটি একটু সাজিয়ে লেখলে পাই 
$$f_{u}(j) - f_{u}(j - 1) = \prod_{v \in \text{child(u)}} f_{v}(j - 1)$$ 
এর দুইপাশে ডিগ্রি সমতা করলে পাব 
$$g(u) - 1 = \sum_{v \in \text{child(u)}} g(v)$$

এই রিকারেন্সটিকে চিনতে পেরেছ? সাবট্রি সাইজ বের করার জন্য আমরা ঠিক এরকম একটি রিকারেন্স ব্যবহার করি। এখান থেকে বোঝা যায় যে $g(u)$ এর মান আসলে $u$ এর সাবট্রি তে যতগুলো নোড আছে তার সমান হবে। অর্থাৎ রুট $1$ এর জন্য পলিনমিয়ালের ডিগ্রি হবে ঠিক ঠিক $n$।  সুতরাং আমাদের $f_{1}(1), f_{1}(2), \dots, f_{1}(n)$ এর মান বের করে পলিনমিয়াল ইন্টারপোলেশন করে দিলেই হচ্ছে। 

এখানেও আমরা গাণিতিক আরোহ ব্যবহার করে পুরো জিনিশটা ফরমালি প্রমাণ করতে পারি। বেস কেইস হবে লিফ নোডগুলো। লিফ নোডগুলোয় $f_{u}(j) = j$ হয়, অর্থাৎ এটাকে আমরা $1$ ডিগ্রি পলিনমিয়াল হিসেবে চিন্তা করতে পারি। লিফ ছাড়া অন্য নোড $u$ এর জন্য চাইল্ডের জন্য $f_{v}$ ($v, \, u$ এর চাইল্ড) পলিনমিয়াল হবে এটা সত্য ধরে নিয়ে $f_{u}$ এর জন্যও পলিনমিয়াল হবে এটা প্রমাণ করতে পারি। 
\end{solution}
